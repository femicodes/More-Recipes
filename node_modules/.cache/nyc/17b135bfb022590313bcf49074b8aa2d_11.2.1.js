'use strict';

var _chai = require('chai');

var _supertest = require('supertest');

var _supertest2 = _interopRequireDefault(_supertest);

var _jsonwebtoken = require('jsonwebtoken');

var _jsonwebtoken2 = _interopRequireDefault(_jsonwebtoken);

var _app = require('../app');

var _app2 = _interopRequireDefault(_app);

function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }

process.env.NODE_ENV = 'test';

var rootURL = '/api/v1';
var recipesUrl = rootURL + '/recipes';
var usersUrl = rootURL + '/users';

var data = {};
var request = (0, _supertest2.default)(_app2.default);

describe('API Integration Tests', function () {
	it('Should return home page', function (done) {
		// calling home page api
		request.get('/api/v1/').end(function (err, res) {
			// console.log(res);
			(0, _chai.expect)(res.status).to.equal(200);
			(0, _chai.expect)(res.body.message).to.equal('Welcome to More Recipes');
			(0, _chai.expect)(res.body.success).to.equal(true);
			done();
		});
	});

	describe('User signup', function () {
		var signupURl = rootURL + '/users/signup';

		beforeEach(function () {
			data = {
				username: 'user1',
				password: 'password',
				email: 'example@user.com'
			};
		});

		it('return 201 for a successful account creation', function (done) {

			request.post(signupURl).send(data).end(function (err, res) {
				// console.log(res);
				(0, _chai.expect)(res.status).to.equal(201);
				(0, _chai.expect)(res.body.success).to.equal(true);
				(0, _chai.expect)(res.body.message).to.equal('Account created successfully');
				done();
			});
		});

		it('return 400 for an already existing email ', function (done) {
			var invalidData = Object.assign({}, data);
			invalidData.username = 'user2';
			request.post(signupURl).send(invalidData).end(function (err, res) {
				(0, _chai.expect)(res.status).to.equal(400);
				(0, _chai.expect)(res.body.success).to.equal(false);
				(0, _chai.expect)(res.body.message).to.equal('Email is already taken, please enter another');
				done();
			});
		});

		it('return 422 for an empty username ', function (done) {
			var invalidData = Object.assign({}, data);
			invalidData.username = ' ';

			request.post(signupURl).send(invalidData).end(function (err, res) {
				(0, _chai.expect)(res.status).to.equal(422);
				(0, _chai.expect)(res.body.message).to.equal('Username is required');
				done();
			});
		});

		it('return 422 for an empty email ', function (done) {
			var invalidData = Object.assign({}, data);
			invalidData.email = '  ';

			request.post(signupURl).send(invalidData).end(function (err, res) {
				(0, _chai.expect)(res.status).to.equal(422);
				(0, _chai.expect)(res.body.message).to.equal('Email is required');
				done();
			});
		});

		it('return 422 for an empty password', function (done) {
			var invalidData = Object.assign({}, data);
			invalidData.password = ' ';

			request.post(signupURl).send(invalidData).end(function (err, res) {
				(0, _chai.expect)(res.status).to.equal(422);
				(0, _chai.expect)(res.body.message).to.equal('Password is required');
				done();
			});
		});

		it('return 422 for an invalid email', function (done) {
			var invalidData = Object.assign({}, data);
			invalidData.email = 'invalidemail';

			request.post(signupURl).send(invalidData).end(function (err, res) {
				(0, _chai.expect)(res.status).to.equal(422);
				(0, _chai.expect)(res.body.message).to.equal('invalid email address');
				done();
			});
		});

		it('return 422 for a password less than 6 characters', function (done) {
			var invalidData = Object.assign({}, data);
			invalidData.password = 'pass';

			request.post(signupURl).send(invalidData).end(function (err, res) {
				(0, _chai.expect)(res.status).to.equal(422);
				(0, _chai.expect)(res.body.message).to.equal('Password must be atleast 6 characters long!');
				done();
			});
		});
	});
});
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInRlc3QuanMiXSwibmFtZXMiOlsicHJvY2VzcyIsImVudiIsIk5PREVfRU5WIiwicm9vdFVSTCIsInJlY2lwZXNVcmwiLCJ1c2Vyc1VybCIsImRhdGEiLCJyZXF1ZXN0IiwiZGVzY3JpYmUiLCJpdCIsImRvbmUiLCJnZXQiLCJlbmQiLCJlcnIiLCJyZXMiLCJzdGF0dXMiLCJ0byIsImVxdWFsIiwiYm9keSIsIm1lc3NhZ2UiLCJzdWNjZXNzIiwic2lnbnVwVVJsIiwiYmVmb3JlRWFjaCIsInVzZXJuYW1lIiwicGFzc3dvcmQiLCJlbWFpbCIsInBvc3QiLCJzZW5kIiwiaW52YWxpZERhdGEiLCJPYmplY3QiLCJhc3NpZ24iXSwibWFwcGluZ3MiOiI7O0FBQ0E7O0FBQ0E7Ozs7QUFDQTs7OztBQUNBOzs7Ozs7QUFFQUEsUUFBUUMsR0FBUixDQUFZQyxRQUFaLEdBQXVCLE1BQXZCOztBQUVBLElBQU1DLFVBQVUsU0FBaEI7QUFDQSxJQUFNQyxhQUFnQkQsT0FBaEIsYUFBTjtBQUNBLElBQU1FLFdBQWNGLE9BQWQsV0FBTjs7QUFHQSxJQUFJRyxPQUFPLEVBQVg7QUFDQSxJQUFNQyxVQUFVLHVDQUFoQjs7QUFFQUMsU0FBUyx1QkFBVCxFQUFrQyxZQUFNO0FBQ3ZDQyxJQUFHLHlCQUFILEVBQThCLFVBQUNDLElBQUQsRUFBVTtBQUN2QztBQUNBSCxVQUFRSSxHQUFSLENBQVksVUFBWixFQUNFQyxHQURGLENBQ00sVUFBU0MsR0FBVCxFQUFjQyxHQUFkLEVBQWtCO0FBQ3RCO0FBQ0EscUJBQU9BLElBQUlDLE1BQVgsRUFBbUJDLEVBQW5CLENBQXNCQyxLQUF0QixDQUE0QixHQUE1QjtBQUNBLHFCQUFPSCxJQUFJSSxJQUFKLENBQVNDLE9BQWhCLEVBQXlCSCxFQUF6QixDQUE0QkMsS0FBNUIsQ0FBa0MseUJBQWxDO0FBQ0EscUJBQU9ILElBQUlJLElBQUosQ0FBU0UsT0FBaEIsRUFBeUJKLEVBQXpCLENBQTRCQyxLQUE1QixDQUFrQyxJQUFsQztBQUNBUDtBQUNB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QixXQUFRbUIsSUFBUixDQUFhTCxTQUFiLEVBQ0VNLElBREYsQ0FDT0MsV0FEUCxFQUVFaEIsR0FGRixDQUVNLFVBQUNDLEdBQUQsRUFBTUMsR0FBTixFQUFjO0FBQ2xCLHNCQUFPQSxJQUFJQyxNQUFYLEVBQW1CQyxFQUFuQixDQUFzQkMsS0FBdEIsQ0FBNEIsR0FBNUI7QUFDQSxzQkFBT0gsSUFBSUksSUFBSixDQUFTQyxPQUFoQixFQUF5QkgsRUFBekIsQ0FBNEJDLEtBQTVCLENBQWtDLDZDQUFsQztBQUNBUDtBQUNBLElBTkY7QUFPQSxHQVhEO0FBY0EsRUF6R0Q7QUEyR0EsQ0F4SEQiLCJmaWxlIjoidGVzdC5qcyIsInNvdXJjZVJvb3QiOiJDOi9Vc2Vycy9Ub2JpL01vcmUtUmVjaXBlcy9zZXJ2ZXIvdGVzdCIsInNvdXJjZXNDb250ZW50IjpbIlxyXG5pbXBvcnQgeyBleHBlY3QgfSBmcm9tICdjaGFpJztcclxuaW1wb3J0IHN1cGVydGVzdCBmcm9tICdzdXBlcnRlc3QnO1xyXG5pbXBvcnQgand0IGZyb20gJ2pzb253ZWJ0b2tlbic7XHJcbmltcG9ydCBhcHAgZnJvbSAnLi4vYXBwJztcclxuXHJcbnByb2Nlc3MuZW52Lk5PREVfRU5WID0gJ3Rlc3QnO1xyXG5cclxuY29uc3Qgcm9vdFVSTCA9ICcvYXBpL3YxJztcclxuY29uc3QgcmVjaXBlc1VybCA9IGAke3Jvb3RVUkx9L3JlY2lwZXNgO1xyXG5jb25zdCB1c2Vyc1VybCA9IGAke3Jvb3RVUkx9L3VzZXJzYDtcclxuXHJcblxyXG5sZXQgZGF0YSA9IHt9O1xyXG5jb25zdCByZXF1ZXN0ID0gc3VwZXJ0ZXN0KGFwcCk7XHJcblxyXG5kZXNjcmliZSgnQVBJIEludGVncmF0aW9uIFRlc3RzJywgKCkgPT4ge1xyXG5cdGl0KCdTaG91bGQgcmV0dXJuIGhvbWUgcGFnZScsIChkb25lKSA9PiB7XHJcblx0XHQvLyBjYWxsaW5nIGhvbWUgcGFnZSBhcGlcclxuXHRcdHJlcXVlc3QuZ2V0KCcvYXBpL3YxLycpXHJcblx0XHRcdC5lbmQoZnVuY3Rpb24oZXJyLCByZXMpe1xyXG5cdFx0XHRcdC8vIGNvbnNvbGUubG9nKHJlcyk7XHJcblx0XHRcdFx0ZXhwZWN0KHJlcy5zdGF0dXMpLnRvLmVxdWFsKDIwMCk7IFxyXG5cdFx0XHRcdGV4cGVjdChyZXMuYm9keS5tZXNzYWdlKS50by5lcXVhbCgnV2VsY29tZSB0byBNb3JlIFJlY2lwZXMnKTtcclxuXHRcdFx0XHRleHBlY3QocmVzLmJvZHkuc3VjY2VzcykudG8uZXF1YWwodHJ1ZSk7XHJcblx0XHRcdFx0ZG9uZSgpO1xyXG5cdFx0XHR9KTtcclxuXHR9KTtcclxuXHJcblx0ZGVzY3JpYmUoJ1VzZXIgc2lnbnVwJywgKCkgPT4ge1xyXG5cdFx0Y29uc3Qgc2lnbnVwVVJsID0gYCR7cm9vdFVSTH0vdXNlcnMvc2lnbnVwYDtcclxuXHRcclxuXHRcdGJlZm9yZUVhY2goKCkgPT4ge1xyXG5cdFx0XHRkYXRhID0ge1xyXG5cdFx0XHRcdHVzZXJuYW1lOiAndXNlcjEnLFxyXG5cdFx0XHRcdHBhc3N3b3JkOiAncGFzc3dvcmQnLFxyXG5cdFx0XHRcdGVtYWlsOiAnZXhhbXBsZUB1c2VyLmNvbScsXHJcblx0XHRcdH07XHJcblx0XHR9KTtcclxuXHRcdFxyXG5cdFx0aXQoJ3JldHVybiAyMDEgZm9yIGEgc3VjY2Vzc2Z1bCBhY2NvdW50IGNyZWF0aW9uJywgKGRvbmUpID0+IHtcclxuXHRcdFx0XHJcblx0XHRcdHJlcXVlc3QucG9zdChzaWdudXBVUmwpXHJcblx0XHRcdFx0LnNlbmQoZGF0YSlcclxuXHRcdFx0XHQuZW5kKChlcnIsIHJlcykgPT4ge1xyXG5cdFx0XHRcdFx0Ly8gY29uc29sZS5sb2cocmVzKTtcclxuXHRcdFx0XHRcdGV4cGVjdChyZXMuc3RhdHVzKS50by5lcXVhbCgyMDEpO1xyXG5cdFx0XHRcdFx0ZXhwZWN0KHJlcy5ib2R5LnN1Y2Nlc3MpLnRvLmVxdWFsKHRydWUpO1xyXG5cdFx0XHRcdFx0ZXhwZWN0KHJlcy5ib2R5Lm1lc3NhZ2UpLnRvLmVxdWFsKCdBY2NvdW50IGNyZWF0ZWQgc3VjY2Vzc2Z1bGx5Jyk7XHJcblx0XHRcdFx0XHRkb25lKCk7XHJcblx0XHRcdFx0fSk7XHJcblx0XHR9KTtcclxuXHJcblx0XHRpdCgncmV0dXJuIDQwMCBmb3IgYW4gYWxyZWFkeSBleGlzdGluZyBlbWFpbCAnLCAoZG9uZSkgPT4ge1xyXG5cdFx0XHRjb25zdCBpbnZhbGlkRGF0YSA9IE9iamVjdC5hc3NpZ24oe30sIGRhdGEpO1xyXG5cdFx0XHRpbnZhbGlkRGF0YS51c2VybmFtZSA9ICd1c2VyMic7XHJcblx0XHRcdHJlcXVlc3QucG9zdChzaWdudXBVUmwpXHJcblx0XHRcdFx0LnNlbmQoaW52YWxpZERhdGEpXHJcblx0XHRcdFx0LmVuZCgoZXJyLCByZXMpID0+IHtcclxuXHRcdFx0XHRcdGV4cGVjdChyZXMuc3RhdHVzKS50by5lcXVhbCg0MDApO1xyXG5cdFx0XHRcdFx0ZXhwZWN0KHJlcy5ib2R5LnN1Y2Nlc3MpLnRvLmVxdWFsKGZhbHNlKTtcclxuXHRcdFx0XHRcdGV4cGVjdChyZXMuYm9keS5tZXNzYWdlKS50by5lcXVhbCgnRW1haWwgaXMgYWxyZWFkeSB0YWtlbiwgcGxlYXNlIGVudGVyIGFub3RoZXInKTtcclxuXHRcdFx0XHRcdGRvbmUoKTtcclxuXHRcdFx0XHR9KTtcclxuXHRcdH0pO1xyXG5cdFx0XHJcblxyXG5cclxuXHRcdGl0KCdyZXR1cm4gNDIyIGZvciBhbiBlbXB0eSB1c2VybmFtZSAnLCAoZG9uZSkgPT4ge1xyXG5cdFx0XHRjb25zdCBpbnZhbGlkRGF0YSA9IE9iamVjdC5hc3NpZ24oe30sIGRhdGEpO1xyXG5cdFx0XHRpbnZhbGlkRGF0YS51c2VybmFtZSA9ICcgJztcclxuXHJcblx0XHRcdHJlcXVlc3QucG9zdChzaWdudXBVUmwpXHJcblx0XHRcdFx0LnNlbmQoaW52YWxpZERhdGEpXHJcblx0XHRcdFx0LmVuZCgoZXJyLCByZXMpID0+IHtcclxuXHRcdFx0XHRcdGV4cGVjdChyZXMuc3RhdHVzKS50by5lcXVhbCg0MjIpO1xyXG5cdFx0XHRcdFx0ZXhwZWN0KHJlcy5ib2R5Lm1lc3NhZ2UpLnRvLmVxdWFsKCdVc2VybmFtZSBpcyByZXF1aXJlZCcpO1xyXG5cdFx0XHRcdFx0ZG9uZSgpO1xyXG5cdFx0XHRcdH0pO1xyXG5cdFx0fSk7XHJcblxyXG5cdFx0aXQoJ3JldHVybiA0MjIgZm9yIGFuIGVtcHR5IGVtYWlsICcsIChkb25lKSA9PiB7XHJcblx0XHRcdGNvbnN0IGludmFsaWREYXRhID0gT2JqZWN0LmFzc2lnbih7fSwgZGF0YSk7XHJcblx0XHRcdGludmFsaWREYXRhLmVtYWlsID0gJyAgJztcclxuXHJcblx0XHRcdHJlcXVlc3QucG9zdChzaWdudXBVUmwpXHJcblx0XHRcdFx0LnNlbmQoaW52YWxpZERhdGEpXHJcblx0XHRcdFx0LmVuZCgoZXJyLCByZXMpID0+IHtcclxuXHRcdFx0XHRcdGV4cGVjdChyZXMuc3RhdHVzKS50by5lcXVhbCg0MjIpO1xyXG5cdFx0XHRcdFx0ZXhwZWN0KHJlcy5ib2R5Lm1lc3NhZ2UpLnRvLmVxdWFsKCdFbWFpbCBpcyByZXF1aXJlZCcpO1xyXG5cdFx0XHRcdFx0ZG9uZSgpO1xyXG5cdFx0XHRcdH0pO1xyXG5cdFx0fSk7XHJcblxyXG5cdFx0aXQoJ3JldHVybiA0MjIgZm9yIGFuIGVtcHR5IHBhc3N3b3JkJywgKGRvbmUpID0+IHtcclxuXHRcdFx0Y29uc3QgaW52YWxpZERhdGEgPSBPYmplY3QuYXNzaWduKHt9LCBkYXRhKTtcclxuXHRcdFx0aW52YWxpZERhdGEucGFzc3dvcmQgPSAnICc7XHJcblxyXG5cdFx0XHRyZXF1ZXN0LnBvc3Qoc2lnbnVwVVJsKVxyXG5cdFx0XHRcdC5zZW5kKGludmFsaWREYXRhKVxyXG5cdFx0XHRcdC5lbmQoKGVyciwgcmVzKSA9PiB7XHJcblx0XHRcdFx0XHRleHBlY3QocmVzLnN0YXR1cykudG8uZXF1YWwoNDIyKTtcclxuXHRcdFx0XHRcdGV4cGVjdChyZXMuYm9keS5tZXNzYWdlKS50by5lcXVhbCgnUGFzc3dvcmQgaXMgcmVxdWlyZWQnKTtcclxuXHRcdFx0XHRcdGRvbmUoKTtcclxuXHRcdFx0XHR9KTtcclxuXHRcdH0pO1xyXG5cclxuXHRcdGl0KCdyZXR1cm4gNDIyIGZvciBhbiBpbnZhbGlkIGVtYWlsJywgKGRvbmUpID0+IHtcclxuXHRcdFx0Y29uc3QgaW52YWxpZERhdGEgPSBPYmplY3QuYXNzaWduKHt9LCBkYXRhKTtcclxuXHRcdFx0aW52YWxpZERhdGEuZW1haWwgPSAnaW52YWxpZGVtYWlsJztcclxuXHJcblx0XHRcdHJlcXVlc3QucG9zdChzaWdudXBVUmwpXHJcblx0XHRcdFx0LnNlbmQoaW52YWxpZERhdGEpXHJcblx0XHRcdFx0LmVuZCgoZXJyLCByZXMpID0+IHtcclxuXHRcdFx0XHRcdGV4cGVjdChyZXMuc3RhdHVzKS50by5lcXVhbCg0MjIpO1xyXG5cdFx0XHRcdFx0ZXhwZWN0KHJlcy5ib2R5Lm1lc3NhZ2UpLnRvLmVxdWFsKCdpbnZhbGlkIGVtYWlsIGFkZHJlc3MnKTtcclxuXHRcdFx0XHRcdGRvbmUoKTtcclxuXHRcdFx0XHR9KTtcclxuXHRcdH0pO1xyXG5cclxuXHRcdGl0KCdyZXR1cm4gNDIyIGZvciBhIHBhc3N3b3JkIGxlc3MgdGhhbiA2IGNoYXJhY3RlcnMnLCAoZG9uZSkgPT4ge1xyXG5cdFx0XHRjb25zdCBpbnZhbGlkRGF0YSA9IE9iamVjdC5hc3NpZ24oe30sIGRhdGEpO1xyXG5cdFx0XHRpbnZhbGlkRGF0YS5wYXNzd29yZCA9ICdwYXNzJztcclxuXHJcblx0XHRcdHJlcXVlc3QucG9zdChzaWdudXBVUmwpXHJcblx0XHRcdFx0LnNlbmQoaW52YWxpZERhdGEpXHJcblx0XHRcdFx0LmVuZCgoZXJyLCByZXMpID0+IHtcclxuXHRcdFx0XHRcdGV4cGVjdChyZXMuc3RhdHVzKS50by5lcXVhbCg0MjIpO1xyXG5cdFx0XHRcdFx0ZXhwZWN0KHJlcy5ib2R5Lm1lc3NhZ2UpLnRvLmVxdWFsKCdQYXNzd29yZCBtdXN0IGJlIGF0bGVhc3QgNiBjaGFyYWN0ZXJzIGxvbmchJyk7XHJcblx0XHRcdFx0XHRkb25lKCk7XHJcblx0XHRcdFx0fSk7XHJcblx0XHR9KTtcclxuXHJcblx0XHRcclxuXHR9KTtcclxuXHJcbn0pO1xyXG4iXX0=