'use strict';

var _chai = require('chai');

var _supertest = require('supertest');

var _supertest2 = _interopRequireDefault(_supertest);

var _jsonwebtoken = require('jsonwebtoken');

var _jsonwebtoken2 = _interopRequireDefault(_jsonwebtoken);

var _app = require('../app');

var _app2 = _interopRequireDefault(_app);

function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }

process.env.NODE_ENV = 'test';

var rootURL = '/api/v1';
var recipesUrl = rootURL + '/recipes';
var usersUrl = rootURL + '/users';

var data = {};
var request = (0, _supertest2.default)(_app2.default);

describe('API Integration Tests', function () {
	it('Should return home page', function (done) {
		// calling home page api
		request.get('/api/v1/').end(function (err, res) {
			// console.log(res);
			(0, _chai.expect)(res.status).to.equal(200);
			(0, _chai.expect)(res.body.message).to.equal('Welcome to More Recipes');
			(0, _chai.expect)(res.body.success).to.equal(true);
			done();
		});
	});

	describe('User signup', function () {
		var signupURl = rootURL + '/users/signup';

		beforeEach(function () {
			data = {
				username: 'user1',
				password: 'password',
				email: 'example@user.com'
			};
		});

		it('return 201 for a successful account creation', function (done) {

			request.post(signupURl).send(data).end(function (err, res) {
				console.log(res);
				(0, _chai.expect)(res.status).to.equal(201);
				(0, _chai.expect)(res.body.success).to.equal(true);
				(0, _chai.expect)(res.body.message).to.equal('Account created successfully');
				done();
			});
		});

		it('return 400 for an already existing email ', function (done) {
			var invalidData = Object.assign({}, data);
			invalidData.username = 'user2';
			request.post(signupURl).send(invalidData).end(function (err, res) {
				(0, _chai.expect)(res.status).to.equal(400);
				(0, _chai.expect)(res.body.message).to.equal('Email is already taken, please enter another');
				done();
			});
		});

		it('return 422 for an empty username ', function (done) {
			var invalidData = Object.assign({}, data);
			invalidData.username = ' ';

			request.post(signupURl).send(invalidData).end(function (err, res) {
				(0, _chai.expect)(res.status).to.equal(422);
				(0, _chai.expect)(res.body.message).to.equal('Username is required');
				done();
			});
		});

		it('return 422 for an empty email ', function (done) {
			var invalidData = Object.assign({}, data);
			invalidData.email = '  ';

			request.post(signupURl).send(invalidData).end(function (err, res) {
				(0, _chai.expect)(res.status).to.equal(422);
				(0, _chai.expect)(res.body.message).to.equal('Email is required');
				done();
			});
		});

		it('return 422 for an empty password', function (done) {
			var invalidData = Object.assign({}, data);
			invalidData.password = ' ';

			request.post(signupURl).send(invalidData).end(function (err, res) {
				(0, _chai.expect)(res.status).to.equal(422);
				(0, _chai.expect)(res.body.message).to.equal('Password is required');
				done();
			});
		});

		it('return 422 for an invalid email', function (done) {
			var invalidData = Object.assign({}, data);
			invalidData.email = 'invalidemail';

			request.post(signupURl).send(invalidData).end(function (err, res) {
				(0, _chai.expect)(res.status).to.equal(422);
				(0, _chai.expect)(res.body.message).to.equal('invalid email address');
				done();
			});
		});

		it('return 422 for a password less than 6 characters', function (done) {
			var invalidData = Object.assign({}, data);
			invalidData.password = 'pass';

			request.post(signupURl).send(invalidData).end(function (err, res) {
				(0, _chai.expect)(res.status).to.equal(422);
				(0, _chai.expect)(res.body.message).to.equal('Password must be atleast 6 characters long!');
				done();
			});
		});
	});
});
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInRlc3QuanMiXSwibmFtZXMiOlsicHJvY2VzcyIsImVudiIsIk5PREVfRU5WIiwicm9vdFVSTCIsInJlY2lwZXNVcmwiLCJ1c2Vyc1VybCIsImRhdGEiLCJyZXF1ZXN0IiwiZGVzY3JpYmUiLCJpdCIsImRvbmUiLCJnZXQiLCJlbmQiLCJlcnIiLCJyZXMiLCJzdGF0dXMiLCJ0byIsImVxdWFsIiwiYm9keSIsIm1lc3NhZ2UiLCJzdWNjZXNzIiwic2lnbnVwVVJsIiwiYmVmb3JlRWFjaCIsInVzZXJuYW1lIiwicGFzc3dvcmQiLCJlbWFpbCIsInBvc3QiLCJzZW5kIiwiY29uc29sZSIsImxvZyIsImludmFsaWREYXRhIiwiT2JqZWN0IiwiYXNzaWduIl0sIm1hcHBpbmdzIjoiOztBQUNBOztBQUNBOzs7O0FBQ0E7Ozs7QUFDQTs7Ozs7O0FBRUFBLFFBQVFDLEdBQVIsQ0FBWUMsUUFBWixHQUF1QixNQUF2Qjs7QUFFQSxJQUFNQyxVQUFVLFNBQWhCO0FBQ0EsSUFBTUMsYUFBZ0JELE9BQWhCLGFBQU47QUFDQSxJQUFNRSxXQUFjRixPQUFkLFdBQU47O0FBR0EsSUFBSUcsT0FBTyxFQUFYO0FBQ0EsSUFBTUMsVUFBVSx1Q0FBaEI7O0FBRUFDLFNBQVMsdUJBQVQsRUFBa0MsWUFBTTtBQUN2Q0MsSUFBRyx5QkFBSCxFQUE4QixVQUFDQyxJQUFELEVBQVU7QUFDdkM7QUFDQUgsVUFBUUksR0FBUixDQUFZLFVBQVosRUFDRUMsR0FERixDQUNNLFVBQVNDLEdBQVQsRUFBY0MsR0FBZCxFQUFrQjtBQUN0QjtBQUNBLHFCQUFPQSxJQUFJQyxNQUFYLEVBQW1CQyxFQUFuQixDQUFzQkMsS0FBdEIsQ0FBNEIsR0FBNUI7QUFDQSxxQkFBT0gsSUFBSUksSUFBSixDQUFTQyxPQUFoQixFQUF5QkgsRUFBekIsQ0FBNEJDLEtBQTVCLENBQWtDLHlCQUFsQztBQUNBLHFCQUFPSCxJQUFJSSxJQUFKLENBQVNFLE9BQWhCLEVBQXlCSixFQUF6QixDQUE0QkMsS0FBNUIsQ0FBa0Ms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RixDQUNPRyxXQURQLEVBRUVsQixHQUZGLENBRU0sVUFBQ0MsR0FBRCxFQUFNQyxHQUFOLEVBQWM7QUFDbEIsc0JBQU9BLElBQUlDLE1BQVgsRUFBbUJDLEVBQW5CLENBQXNCQyxLQUF0QixDQUE0QixHQUE1QjtBQUNBLHNCQUFPSCxJQUFJSSxJQUFKLENBQVNDLE9BQWhCLEVBQXlCSCxFQUF6QixDQUE0QkMsS0FBNUIsQ0FBa0MsNkNBQWxDO0FBQ0FQO0FBQ0EsSUFORjtBQU9BLEdBWEQ7QUFjQSxFQXRHRDtBQXdHQSxDQXJIRCIsImZpbGUiOiJ0ZXN0LmpzIiwic291cmNlUm9vdCI6IkM6L1VzZXJzL1RvYmkvTW9yZS1SZWNpcGVzL3NlcnZlci90ZXN0Iiwic291cmNlc0NvbnRlbnQiOlsiXHJcbmltcG9ydCB7IGV4cGVjdCB9IGZyb20gJ2NoYWknO1xyXG5pbXBvcnQgc3VwZXJ0ZXN0IGZyb20gJ3N1cGVydGVzdCc7XHJcbmltcG9ydCBqd3QgZnJvbSAnanNvbndlYnRva2VuJztcclxuaW1wb3J0IGFwcCBmcm9tICcuLi9hcHAnO1xyXG5cclxucHJvY2Vzcy5lbnYuTk9ERV9FTlYgPSAndGVzdCc7XHJcblxyXG5jb25zdCByb290VVJMID0gJy9hcGkvdjEnO1xyXG5jb25zdCByZWNpcGVzVXJsID0gYCR7cm9vdFVSTH0vcmVjaXBlc2A7XHJcbmNvbnN0IHVzZXJzVXJsID0gYCR7cm9vdFVSTH0vdXNlcnNgO1xyXG5cclxuXHJcbmxldCBkYXRhID0ge307XHJcbmNvbnN0IHJlcXVlc3QgPSBzdXBlcnRlc3QoYXBwKTtcclxuXHJcbmRlc2NyaWJlKCdBUEkgSW50ZWdyYXRpb24gVGVzdHMnLCAoKSA9PiB7XHJcblx0aXQoJ1Nob3VsZCByZXR1cm4gaG9tZSBwYWdlJywgKGRvbmUpID0+IHtcclxuXHRcdC8vIGNhbGxpbmcgaG9tZSBwYWdlIGFwaVxyXG5cdFx0cmVxdWVzdC5nZXQoJy9hcGkvdjEvJylcclxuXHRcdFx0LmVuZChmdW5jdGlvbihlcnIsIHJlcyl7XHJcblx0XHRcdFx0Ly8gY29uc29sZS5sb2cocmVzKTtcclxuXHRcdFx0XHRleHBlY3QocmVzLnN0YXR1cykudG8uZXF1YWwoMjAwKTsgXHJcblx0XHRcdFx0ZXhwZWN0KHJlcy5ib2R5Lm1lc3NhZ2UpLnRvLmVxdWFsKCdXZWxjb21lIHRvIE1vcmUgUmVjaXBlcycpO1xyXG5cdFx0XHRcdGV4cGVjdChyZXMuYm9keS5zdWNjZXNzKS50by5lcXVhbCh0cnVlKTtcclxuXHRcdFx0XHRkb25lKCk7XHJcblx0XHRcdH0pO1xyXG5cdH0pO1xyXG5cclxuXHRkZXNjcmliZSgnVXNlciBzaWdudXAnLCAoKSA9PiB7XHJcblx0XHRjb25zdCBzaWdudXBVUmwgPSBgJHtyb290VVJMfS91c2Vycy9zaWdudXBgO1xyXG5cdFxyXG5cdFx0YmVmb3JlRWFjaCgoKSA9PiB7XHJcblx0XHRcdGRhdGEgPSB7XHJcblx0XHRcdFx0dXNlcm5hbWU6ICd1c2VyMScsXHJcblx0XHRcdFx0cGFzc3dvcmQ6ICdwYXNzd29yZCcsXHJcblx0XHRcdFx0ZW1haWw6ICdleGFtcGxlQHVzZXIuY29tJyxcclxuXHRcdFx0fTtcclxuXHRcdH0pO1xyXG5cdFx0XHJcblx0XHRpdCgncmV0dXJuIDIwMSBmb3IgYSBzdWNjZXNzZnVsIGFjY291bnQgY3JlYXRpb24nLCAoZG9uZSkgPT4ge1xyXG5cdFx0XHRcclxuXHRcdFx0cmVxdWVzdC5wb3N0KHNpZ251cFVSbClcclxuXHRcdFx0XHQuc2VuZChkYXRhKVxyXG5cdFx0XHRcdC5lbmQoKGVyciwgcmVzKSA9PiB7XHJcblx0XHRcdFx0XHRjb25zb2xlLmxvZyhyZXMpO1xyXG5cdFx0XHRcdFx0ZXhwZWN0KHJlcy5zdGF0dXMpLnRvLmVxdWFsKDIwMSk7XHJcblx0XHRcdFx0XHRleHBlY3QocmVzLmJvZHkuc3VjY2VzcykudG8uZXF1YWwodHJ1ZSk7XHJcblx0XHRcdFx0XHRleHBlY3QocmVzLmJvZHkubWVzc2FnZSkudG8uZXF1YWwoJ0FjY291bnQgY3JlYXRlZCBzdWNjZXNzZnVsbHknKTtcclxuXHRcdFx0XHRcdGRvbmUoKTtcclxuXHRcdFx0XHR9KTtcclxuXHRcdH0pO1xyXG5cclxuXHRcdGl0KCdyZXR1cm4gNDAwIGZvciBhbiBhbHJlYWR5IGV4aXN0aW5nIGVtYWlsICcsIChkb25lKSA9PiB7XHJcblx0XHRcdGNvbnN0IGludmFsaWREYXRhID0gT2JqZWN0LmFzc2lnbih7fSwgZGF0YSk7XHJcblx0XHRcdGludmFsaWREYXRhLnVzZXJuYW1lID0gJ3VzZXIyJztcclxuXHRcdFx0cmVxdWVzdC5wb3N0KHNpZ251cFVSbClcclxuXHRcdFx0ICAuc2VuZChpbnZhbGlkRGF0YSlcclxuXHRcdFx0ICAuZW5kKChlcnIsIHJlcykgPT4ge1xyXG5cdFx0XHRcdFx0ZXhwZWN0KHJlcy5zdGF0dXMpLnRvLmVxdWFsKDQwMCk7XHJcblx0XHRcdFx0XHRleHBlY3QocmVzLmJvZHkubWVzc2FnZSkudG8uZXF1YWwoJ0VtYWlsIGlzIGFscmVhZHkgdGFrZW4sIHBsZWFzZSBlbnRlciBhbm90aGVyJyk7XHJcblx0XHRcdFx0XHRkb25lKCk7XHJcblx0XHRcdCAgfSk7XHJcblx0XHQgIH0pO1xyXG5cclxuXHRcdGl0KCdyZXR1cm4gNDIyIGZvciBhbiBlbXB0eSB1c2VybmFtZSAnLCAoZG9uZSkgPT4ge1xyXG5cdFx0XHRjb25zdCBpbnZhbGlkRGF0YSA9IE9iamVjdC5hc3NpZ24oe30sIGRhdGEpO1xyXG5cdFx0XHRpbnZhbGlkRGF0YS51c2VybmFtZSA9ICcgJztcclxuXHJcblx0XHRcdHJlcXVlc3QucG9zdChzaWdudXBVUmwpXHJcblx0XHRcdFx0LnNlbmQoaW52YWxpZERhdGEpXHJcblx0XHRcdFx0LmVuZCgoZXJyLCByZXMpID0+IHtcclxuXHRcdFx0XHRcdGV4cGVjdChyZXMuc3RhdHVzKS50by5lcXVhbCg0MjIpO1xyXG5cdFx0XHRcdFx0ZXhwZWN0KHJlcy5ib2R5Lm1lc3NhZ2UpLnRvLmVxdWFsKCdVc2VybmFtZSBpcyByZXF1aXJlZCcpO1xyXG5cdFx0XHRcdFx0ZG9uZSgpO1xyXG5cdFx0XHRcdH0pO1xyXG5cdFx0fSk7XHJcblxyXG5cdFx0aXQoJ3JldHVybiA0MjIgZm9yIGFuIGVtcHR5IGVtYWlsICcsIChkb25lKSA9PiB7XHJcblx0XHRcdGNvbnN0IGludmFsaWREYXRhID0gT2JqZWN0LmFzc2lnbih7fSwgZGF0YSk7XHJcblx0XHRcdGludmFsaWREYXRhLmVtYWlsID0gJyAgJztcclxuXHJcblx0XHRcdHJlcXVlc3QucG9zdChzaWdudXBVUmwpXHJcblx0XHRcdFx0LnNlbmQoaW52YWxpZERhdGEpXHJcblx0XHRcdFx0LmVuZCgoZXJyLCByZXMpID0+IHtcclxuXHRcdFx0XHRcdGV4cGVjdChyZXMuc3RhdHVzKS50by5lcXVhbCg0MjIpO1xyXG5cdFx0XHRcdFx0ZXhwZWN0KHJlcy5ib2R5Lm1lc3NhZ2UpLnRvLmVxdWFsKCdFbWFpbCBpcyByZXF1aXJlZCcpO1xyXG5cdFx0XHRcdFx0ZG9uZSgpO1xyXG5cdFx0XHRcdH0pO1xyXG5cdFx0fSk7XHJcblxyXG5cdFx0aXQoJ3JldHVybiA0MjIgZm9yIGFuIGVtcHR5IHBhc3N3b3JkJywgKGRvbmUpID0+IHtcclxuXHRcdFx0Y29uc3QgaW52YWxpZERhdGEgPSBPYmplY3QuYXNzaWduKHt9LCBkYXRhKTtcclxuXHRcdFx0aW52YWxpZERhdGEucGFzc3dvcmQgPSAnICc7XHJcblxyXG5cdFx0XHRyZXF1ZXN0LnBvc3Qoc2lnbnVwVVJsKVxyXG5cdFx0XHRcdC5zZW5kKGludmFsaWREYXRhKVxyXG5cdFx0XHRcdC5lbmQoKGVyciwgcmVzKSA9PiB7XHJcblx0XHRcdFx0XHRleHBlY3QocmVzLnN0YXR1cykudG8uZXF1YWwoNDIyKTtcclxuXHRcdFx0XHRcdGV4cGVjdChyZXMuYm9keS5tZXNzYWdlKS50by5lcXVhbCgnUGFzc3dvcmQgaXMgcmVxdWlyZWQnKTtcclxuXHRcdFx0XHRcdGRvbmUoKTtcclxuXHRcdFx0XHR9KTtcclxuXHRcdH0pO1xyXG5cclxuXHRcdGl0KCdyZXR1cm4gNDIyIGZvciBhbiBpbnZhbGlkIGVtYWlsJywgKGRvbmUpID0+IHtcclxuXHRcdFx0Y29uc3QgaW52YWxpZERhdGEgPSBPYmplY3QuYXNzaWduKHt9LCBkYXRhKTtcclxuXHRcdFx0aW52YWxpZERhdGEuZW1haWwgPSAnaW52YWxpZGVtYWlsJztcclxuXHJcblx0XHRcdHJlcXVlc3QucG9zdChzaWdudXBVUmwpXHJcblx0XHRcdFx0LnNlbmQoaW52YWxpZERhdGEpXHJcblx0XHRcdFx0LmVuZCgoZXJyLCByZXMpID0+IHtcclxuXHRcdFx0XHRcdGV4cGVjdChyZXMuc3RhdHVzKS50by5lcXVhbCg0MjIpO1xyXG5cdFx0XHRcdFx0ZXhwZWN0KHJlcy5ib2R5Lm1lc3NhZ2UpLnRvLmVxdWFsKCdpbnZhbGlkIGVtYWlsIGFkZHJlc3MnKTtcclxuXHRcdFx0XHRcdGRvbmUoKTtcclxuXHRcdFx0XHR9KTtcclxuXHRcdH0pO1xyXG5cclxuXHRcdGl0KCdyZXR1cm4gNDIyIGZvciBhIHBhc3N3b3JkIGxlc3MgdGhhbiA2IGNoYXJhY3RlcnMnLCAoZG9uZSkgPT4ge1xyXG5cdFx0XHRjb25zdCBpbnZhbGlkRGF0YSA9IE9iamVjdC5hc3NpZ24oe30sIGRhdGEpO1xyXG5cdFx0XHRpbnZhbGlkRGF0YS5wYXNzd29yZCA9ICdwYXNzJztcclxuXHJcblx0XHRcdHJlcXVlc3QucG9zdChzaWdudXBVUmwpXHJcblx0XHRcdFx0LnNlbmQoaW52YWxpZERhdGEpXHJcblx0XHRcdFx0LmVuZCgoZXJyLCByZXMpID0+IHtcclxuXHRcdFx0XHRcdGV4cGVjdChyZXMuc3RhdHVzKS50by5lcXVhbCg0MjIpO1xyXG5cdFx0XHRcdFx0ZXhwZWN0KHJlcy5ib2R5Lm1lc3NhZ2UpLnRvLmVxdWFsKCdQYXNzd29yZCBtdXN0IGJlIGF0bGVhc3QgNiBjaGFyYWN0ZXJzIGxvbmchJyk7XHJcblx0XHRcdFx0XHRkb25lKCk7XHJcblx0XHRcdFx0fSk7XHJcblx0XHR9KTtcclxuXHJcblx0XHRcclxuXHR9KTtcclxuXHJcbn0pO1xyXG4iXX0=